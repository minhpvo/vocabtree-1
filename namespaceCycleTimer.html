<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>vocabtree: CycleTimer Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">vocabtree
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="namespaces.html"><span>Namespace&#160;List</span></a></li>
      <li><a href="namespacemembers.html"><span>Namespace&#160;Members</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('namespaceCycleTimer.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CycleTimer Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This uses the cycle counter of the processor.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a756e51d31680afd939df5b3c3bcf599d"><td class="memItemLeft" align="right" valign="top">typedef unsigned long long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#a756e51d31680afd939df5b3c3bcf599d">SysClock</a></td></tr>
<tr class="separator:a756e51d31680afd939df5b3c3bcf599d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a08ffb5235af5b72ae4383d7238fa4490"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceCycleTimer.html#a756e51d31680afd939df5b3c3bcf599d">SysClock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#a08ffb5235af5b72ae4383d7238fa4490">currentTicks</a> ()</td></tr>
<tr class="memdesc:a08ffb5235af5b72ae4383d7238fa4490"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current CPU time, in terms of clock ticks.  <a href="#a08ffb5235af5b72ae4383d7238fa4490">More...</a><br/></td></tr>
<tr class="separator:a08ffb5235af5b72ae4383d7238fa4490"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5099b2bd5a6f211a3982c2fd03b44e29"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#a5099b2bd5a6f211a3982c2fd03b44e29">tickUnits</a> ()</td></tr>
<tr class="separator:a5099b2bd5a6f211a3982c2fd03b44e29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0808d22d25de40774ec85e2dd995a457"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#a0808d22d25de40774ec85e2dd995a457">secondsPerTick</a> ()</td></tr>
<tr class="memdesc:a0808d22d25de40774ec85e2dd995a457"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the conversion from ticks to seconds.  <a href="#a0808d22d25de40774ec85e2dd995a457">More...</a><br/></td></tr>
<tr class="separator:a0808d22d25de40774ec85e2dd995a457"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed721398a8329a4c2cc293201a819b85"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#aed721398a8329a4c2cc293201a819b85">msPerTick</a> ()</td></tr>
<tr class="memdesc:aed721398a8329a4c2cc293201a819b85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the conversion from ticks to milliseconds.  <a href="#aed721398a8329a4c2cc293201a819b85">More...</a><br/></td></tr>
<tr class="separator:aed721398a8329a4c2cc293201a819b85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a283f1082702ac6d85b86880d29d53ee4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#a283f1082702ac6d85b86880d29d53ee4">currentSeconds</a> ()</td></tr>
<tr class="memdesc:a283f1082702ac6d85b86880d29d53ee4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the current CPU time, in terms of seconds.  <a href="#a283f1082702ac6d85b86880d29d53ee4">More...</a><br/></td></tr>
<tr class="separator:a283f1082702ac6d85b86880d29d53ee4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d6344da8d39071adf37cca332d218b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceCycleTimer.html#a97d6344da8d39071adf37cca332d218b">ticksPerSecond</a> ()</td></tr>
<tr class="memdesc:a97d6344da8d39071adf37cca332d218b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the conversion from seconds to ticks.  <a href="#a97d6344da8d39071adf37cca332d218b">More...</a><br/></td></tr>
<tr class="separator:a97d6344da8d39071adf37cca332d218b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This uses the cycle counter of the processor. </p>
<p>Different processors in the system will have different values for this. If you process moves across processors, then the delta time you measure will likely be incorrect. This is mostly for fine grained measurements where the process is likely to be on the same processor. For more global things you should use the Time interface.</p>
<p>Also note that if you processors' speeds change (i.e. processors scaling) or if you are in a heterogenous environment, you will likely get spurious results. </p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a756e51d31680afd939df5b3c3bcf599d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef unsigned long long <a class="el" href="namespaceCycleTimer.html#a756e51d31680afd939df5b3c3bcf599d">CycleTimer::SysClock</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00037">37</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a283f1082702ac6d85b86880d29d53ee4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double CycleTimer::currentSeconds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the current CPU time, in terms of seconds. </p>
<p>This is slower than <a class="el" href="namespaceCycleTimer.html#a08ffb5235af5b72ae4383d7238fa4490" title="Return the current CPU time, in terms of clock ticks.">currentTicks()</a>. Time zero is at some arbitrary point in the past. </p>

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00157">157</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>

<p>References <a class="el" href="cycletimer_8hpp_source.html#l00041">currentTicks()</a>, and <a class="el" href="cycletimer_8hpp_source.html#l00075">secondsPerTick()</a>.</p>

<p>Referenced by <a class="el" href="bench__search_8cxx_source.html#l00027">bench_oxford()</a>, and <a class="el" href="bench__all_8cxx_source.html#l00125">benchmark_dataset()</a>.</p>
<div class="fragment"><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                 {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceCycleTimer.html#a08ffb5235af5b72ae4383d7238fa4490" title="Return the current CPU time, in terms of clock ticks.">currentTicks</a>() * <a class="code" href="namespaceCycleTimer.html#a0808d22d25de40774ec85e2dd995a457" title="Return the conversion from ticks to seconds.">secondsPerTick</a>();</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a08ffb5235af5b72ae4383d7238fa4490"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceCycleTimer.html#a756e51d31680afd939df5b3c3bcf599d">SysClock</a> CycleTimer::currentTicks </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the current CPU time, in terms of clock ticks. </p>
<p>Time zero is at some arbitrary point in the past. </p>

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00041">41</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>

<p>Referenced by <a class="el" href="cycletimer_8hpp_source.html#l00157">currentSeconds()</a>.</p>
<div class="fragment"><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;                                 {</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#if defined(__APPLE__) &amp;&amp; !defined(__x86_64__)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">return</span> mach_absolute_time();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#elif defined(_WIN32)</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor"></span>    LARGE_INTEGER qwTime;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    QueryPerformanceCounter(&amp;qwTime);</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">return</span> qwTime.QuadPart;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#elif defined(__x86_64__)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> a, d;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;rdtsc&quot;</span> : <span class="stringliteral">&quot;=a&quot;</span> (a), <span class="stringliteral">&quot;=d&quot;</span> (d));</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> <span class="keywordtype">long</span><span class="keyword">&gt;</span>(a) |</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;      (static_cast&lt;unsigned long long&gt;(d) &lt;&lt; 32);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="preprocessor">#elif defined(__ARM_NEON__) &amp;&amp; 0 // mrc requires superuser.</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> val;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keyword">asm</span> <span class="keyword">volatile</span>(<span class="stringliteral">&quot;mrc p15, 0, %0, c9, c13, 0&quot;</span> : <span class="stringliteral">&quot;=r&quot;</span>(val));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="preprocessor"></span>    timespec spec;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    clock_gettime(CLOCK_THREAD_CPUTIME_ID, &amp;spec);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceCycleTimer.html#a756e51d31680afd939df5b3c3bcf599d">CycleTimer::SysClock</a>(static_cast&lt;float&gt;(spec.tv_sec) * 1e9 + static_cast&lt;float&gt;(spec.tv_nsec));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="preprocessor"></span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed721398a8329a4c2cc293201a819b85"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double CycleTimer::msPerTick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the conversion from ticks to milliseconds. </p>

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00150">150</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>

<p>References <a class="el" href="cycletimer_8hpp_source.html#l00075">secondsPerTick()</a>.</p>
<div class="fragment"><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                            {</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceCycleTimer.html#a0808d22d25de40774ec85e2dd995a457" title="Return the conversion from ticks to seconds.">secondsPerTick</a>() * 1000.0;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0808d22d25de40774ec85e2dd995a457"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double CycleTimer::secondsPerTick </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the conversion from ticks to seconds. </p>

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00075">75</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>

<p>Referenced by <a class="el" href="cycletimer_8hpp_source.html#l00157">currentSeconds()</a>, <a class="el" href="cycletimer_8hpp_source.html#l00150">msPerTick()</a>, and <a class="el" href="cycletimer_8hpp_source.html#l00162">ticksPerSecond()</a>.</p>
<div class="fragment"><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                 {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> initialized = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> secondsPerTick_val;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keywordflow">if</span> (initialized) <span class="keywordflow">return</span> secondsPerTick_val;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="preprocessor">#if defined(__APPLE__)</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#ifdef __x86_64__</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="preprocessor"></span>    <span class="keywordtype">int</span> args[] = {CTL_HW, HW_CPU_FREQ};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Hz;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    <span class="keywordtype">size_t</span> len = <span class="keyword">sizeof</span>(Hz);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span> (sysctl(args, 2, &amp;Hz, &amp;len, NULL, 0) != 0) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;       fprintf(stderr, <span class="stringliteral">&quot;Failed to initialize secondsPerTick_val!\n&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;       exit(-1);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    secondsPerTick_val = 1.0 / (double) Hz;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="preprocessor"></span>    mach_timebase_info_data_t time_info;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    mach_timebase_info(&amp;time_info);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">// Scales to nanoseconds without 1e-9f</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    secondsPerTick_val = (1e-9*<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(time_info.numer))/</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(time_info.denom);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="preprocessor">#endif // x86_64 or not</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor"></span><span class="preprocessor">#elif defined(_WIN32)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="preprocessor"></span>    LARGE_INTEGER qwTicksPerSec;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    QueryPerformanceFrequency(&amp;qwTicksPerSec);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    secondsPerTick_val = 1.0/<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(qwTicksPerSec.QuadPart);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="preprocessor"></span>    FILE *fp = fopen(<span class="stringliteral">&quot;/proc/cpuinfo&quot;</span>,<span class="stringliteral">&quot;r&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordtype">char</span> input[1024];</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">if</span> (!fp) {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;       fprintf(stderr, <span class="stringliteral">&quot;CycleTimer::resetScale failed: couldn&#39;t find /proc/cpuinfo.&quot;</span>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;       exit(-1);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// In case we don&#39;t find it, e.g. on the N900</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    secondsPerTick_val = 1e-9;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">while</span> (!feof(fp) &amp;&amp; fgets(input, 1024, fp)) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="comment">// NOTE(boulos): Because reading cpuinfo depends on dynamic</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="comment">// frequency scaling it&#39;s better to read the @ sign first</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keywordtype">float</span> GHz, MHz;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span> (strstr(input, <span class="stringliteral">&quot;model name&quot;</span>)) {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordtype">char</span>* at_sign = strstr(input, <span class="stringliteral">&quot;@&quot;</span>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <span class="keywordflow">if</span> (at_sign) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;          <span class="keywordtype">char</span>* after_at = at_sign + 1;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;          <span class="keywordtype">char</span>* GHz_str = strstr(after_at, <span class="stringliteral">&quot;GHz&quot;</span>);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          <span class="keywordtype">char</span>* MHz_str = strstr(after_at, <span class="stringliteral">&quot;MHz&quot;</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;          <span class="keywordflow">if</span> (GHz_str) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            *GHz_str = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            <span class="keywordflow">if</span> (1 == sscanf(after_at, <span class="stringliteral">&quot;%f&quot;</span>, &amp;GHz)) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;              <span class="comment">//printf(&quot;GHz = %f\n&quot;, GHz);</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;              secondsPerTick_val = 1e-9f / GHz;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (MHz_str) {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            *MHz_str = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="keywordflow">if</span> (1 == sscanf(after_at, <span class="stringliteral">&quot;%f&quot;</span>, &amp;MHz)) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;              <span class="comment">//printf(&quot;MHz = %f\n&quot;, MHz);</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;              secondsPerTick_val = 1e-6f / GHz;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            }</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;          }</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        }</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (1 == sscanf(input, <span class="stringliteral">&quot;cpu MHz : %f&quot;</span>, &amp;MHz)) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="comment">//printf(&quot;MHz = %f\n&quot;, MHz);</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        secondsPerTick_val = 1e-6f / MHz;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    fclose(fp);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="preprocessor"></span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    initialized = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordflow">return</span> secondsPerTick_val;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a97d6344da8d39071adf37cca332d218b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double CycleTimer::ticksPerSecond </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return the conversion from seconds to ticks. </p>

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00162">162</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>

<p>References <a class="el" href="cycletimer_8hpp_source.html#l00075">secondsPerTick()</a>.</p>
<div class="fragment"><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                 {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="keywordflow">return</span> 1.0/<a class="code" href="namespaceCycleTimer.html#a0808d22d25de40774ec85e2dd995a457" title="Return the conversion from ticks to seconds.">secondsPerTick</a>();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5099b2bd5a6f211a3982c2fd03b44e29"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const char* CycleTimer::tickUnits </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="cycletimer_8hpp_source.html#l00064">64</a> of file <a class="el" href="cycletimer_8hpp_source.html">cycletimer.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                 {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="preprocessor">#if defined(__APPLE__) &amp;&amp; !defined(__x86_64__)</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;ns&quot;</span>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="preprocessor">#elif defined(__WIN32__) || defined(__x86_64__)</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;cycles&quot;</span>;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="preprocessor"></span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;ns&quot;</span>; <span class="comment">// clock_gettime</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor"></span>  }</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespaceCycleTimer.html">CycleTimer</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.3.1 </li>
  </ul>
</div>
</body>
</html>
